<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Swatchy - A suite of color tools for Ohuhu markers">
  <title>{% block title %}Swatchy{% endblock %}</title>
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/favicon.png') }}">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: {
              50: '#fdf4ff',
              100: '#fae8ff',
              200: '#f5d0fe',
              300: '#f0abfc',
              400: '#e879f9',
              500: '#d946ef',
              600: '#c026d3',
              700: '#a21caf',
              800: '#86198f',
              900: '#701a75',
            },
            coral: {
              400: '#fb7185',
              500: '#f43f5e',
              600: '#e11d48',
            }
          }
        }
      }
    }
  </script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Comfortaa:wght@400;500;600;700&display=swap');
    body { font-family: 'Poppins', sans-serif; }
    .font-comfortaa { font-family: 'Comfortaa', sans-serif; }
    .gradient-bg {
      background: linear-gradient(135deg, #fdf4ff 0%, #fff1f2 25%, #fff7ed 50%, #f0fdf4 75%, #ecfeff 100%);
    }
    .card-hover {
      transition: all 0.3s ease;
    }
    .card-hover:hover {
      transform: translateY(-4px);
      box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.15);
    }
    .tool-icon {
      background: linear-gradient(135deg, #d946ef 0%, #f43f5e 50%, #f97316 100%);
    }
  </style>
  {% block extra_css %}{% endblock %}
</head>
<body class="gradient-bg min-h-screen">
  <!-- Navigation -->
  <nav class="bg-white/80 backdrop-blur-md border-b border-gray-200 sticky top-0 z-50">
    <div class="container mx-auto px-4">
      <div class="flex items-center justify-between h-16">
        <a href="/" class="flex items-center gap-2 group">
          <img src="{{ url_for('static', filename='images/swatchy_logo.png') }}" alt="Swatchy" class="h-12 w-auto object-contain rounded-lg">
          <span class="font-comfortaa text-2xl text-gray-800">Swatchy</span>
        </a>

        <!-- Desktop Navigation -->
        <div class="hidden md:flex items-center gap-1">
          <a href="/color-wheel" class="px-4 py-2 rounded-lg text-gray-600 hover:text-primary-600 hover:bg-primary-50 transition-colors text-sm font-medium">Color Wheel</a>
          <a href="/palette-generator" class="px-4 py-2 rounded-lg text-gray-600 hover:text-primary-600 hover:bg-primary-50 transition-colors text-sm font-medium">Palette Generator</a>
          <a href="/theme-library" class="px-4 py-2 rounded-lg text-gray-600 hover:text-primary-600 hover:bg-primary-50 transition-colors text-sm font-medium">Theme Library</a>
          <a href="/image-picker" class="px-4 py-2 rounded-lg text-gray-600 hover:text-primary-600 hover:bg-primary-50 transition-colors text-sm font-medium">Image Picker</a>
          <a href="/color-picker" class="px-4 py-2 rounded-lg text-gray-600 hover:text-primary-600 hover:bg-primary-50 transition-colors text-sm font-medium">Color Picker</a>
        </div>

        <!-- Mobile Menu Button -->
        <button id="mobileMenuBtn" class="md:hidden p-2 rounded-lg hover:bg-gray-100">
          <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>

      <!-- Mobile Navigation -->
      <div id="mobileMenu" class="hidden md:hidden pb-4">
        <div class="flex flex-col gap-1">
          <a href="/color-wheel" class="px-4 py-3 rounded-lg text-gray-600 hover:text-primary-600 hover:bg-primary-50 transition-colors text-sm font-medium">Color Wheel</a>
          <a href="/palette-generator" class="px-4 py-3 rounded-lg text-gray-600 hover:text-primary-600 hover:bg-primary-50 transition-colors text-sm font-medium">Palette Generator</a>
          <a href="/theme-library" class="px-4 py-3 rounded-lg text-gray-600 hover:text-primary-600 hover:bg-primary-50 transition-colors text-sm font-medium">Theme Library</a>
          <a href="/image-picker" class="px-4 py-3 rounded-lg text-gray-600 hover:text-primary-600 hover:bg-primary-50 transition-colors text-sm font-medium">Image Picker</a>
          <a href="/color-picker" class="px-4 py-3 rounded-lg text-gray-600 hover:text-primary-600 hover:bg-primary-50 transition-colors text-sm font-medium">Color Picker</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="container mx-auto px-4 py-8">
    {% block content %}{% endblock %}
  </main>

  <!-- Footer -->
  <footer class="border-t border-gray-200 bg-white/50 mt-auto">
    <div class="container mx-auto px-4 py-6">
      <div class="flex flex-col md:flex-row items-center justify-between gap-4">
        <p class="text-sm text-gray-500">Swatchy - Color tools for Ohuhu markers</p>
        <div class="flex items-center gap-4">
          <span class="text-xs text-gray-400">540+ marker colors</span>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // Mobile menu toggle
    document.getElementById('mobileMenuBtn').addEventListener('click', () => {
      document.getElementById('mobileMenu').classList.toggle('hidden');
    });

    // Shared color utilities
    function hexToHSV(hex) {
      hex = hex.replace(/^#/, '');
      const r = parseInt(hex.slice(0, 2), 16) / 255;
      const g = parseInt(hex.slice(2, 4), 16) / 255;
      const b = parseInt(hex.slice(4, 6), 16) / 255;

      const max = Math.max(r, g, b);
      const min = Math.min(r, g, b);
      const diff = max - min;

      let h = 0;
      let s = max === 0 ? 0 : diff / max;
      let v = max;

      if (diff !== 0) {
        switch (max) {
          case r: h = 60 * (((g - b) / diff) % 6); break;
          case g: h = 60 * ((b - r) / diff + 2); break;
          case b: h = 60 * ((r - g) / diff + 4); break;
        }
      }

      h = h < 0 ? h + 360 : h;
      return { h, s: s * 100, v: v * 100 };
    }

    function calculateBrightness(hex) {
      const r = parseInt(hex.slice(1, 3), 16);
      const g = parseInt(hex.slice(3, 5), 16);
      const b = parseInt(hex.slice(5, 7), 16);
      return (r * 299 + g * 587 + b * 114) / 1000;
    }

    function getTextColor(hex) {
      return calculateBrightness(hex) > 128 ? '#000' : '#fff';
    }

    // Load color data
    let colorData = {};
    let markers = [];

    async function loadColorData() {
      try {
        const response = await fetch('/static/data/ColorData.json');
        const result = await response.json();
        colorData = result.data;

        markers = [];
        for (const data of colorData) {
          const name = data['Color Name'];
          if (!data.Hex || name === 'Colorless Blender') continue;

          const lines = [];
          if (data.Honolulu) lines.push('Honolulu');
          if (data.Oahu) lines.push('Oahu');
          if (data.Kaala) lines.push('Kaala');

          markers.push({
            name,
            hex: data.Hex,
            code: data.New,
            lines,
            data,
            hsv: hexToHSV(data.Hex)
          });
        }

        return markers;
      } catch (error) {
        console.error('Error loading color data:', error);
        return [];
      }
    }
  </script>
  {% block extra_js %}{% endblock %}
</body>
</html>
